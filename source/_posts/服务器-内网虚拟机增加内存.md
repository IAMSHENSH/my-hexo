---
title: 服务器的虚拟机增加内存
date: 2017-09-11
tags: 
- 虚拟机
- 服务器
- 内存
- douker
- note
categories: 服务器
---

> 关于在服务器增加虚拟机内存的方法

<!-- more -->

## 背景

大家在 project-a 上的分支没办法 `clone` 与 `pull`。
原因是：服务器上分配给 git 可用内存不够。导致服务器在打包 git 仓库的过程中失败了。

## 目的

因此决定，增加 Git 所在容器的虚拟机的内存。目前分配了 4G，现打算增加到 16GB。

## 过程

给虚拟机增加内存的过程非常简单。
> 其中 GitLab 为正在使用的 GitLab 托管平台 , 「虚拟机 C1」 为部署有Docker负债均衡的虚拟机
1. 停止 「GitLab 容器」；
1. 停止「虚拟机 C1」；
1. 设置「虚拟机 C1」的内存为 16GB；
1. 启动「虚拟机 C1」；
1. 在虚拟机输入命令 `docker ps`，以启动负载均衡的组件；
1. 启动 「GitLab 容器」；

> 后记
>
然后发现分配 16GB 太大了。
虚拟机在使用了内存后，是不会还给宿主机的。
因此导致宿主机服务器内存占用率一直在 98% 。
可能因为虚拟机使用的是 VMware （不知道其他虚拟机是不是也这样）。
所以最后调整「虚拟机 C1」分配为 12GB 内存；


